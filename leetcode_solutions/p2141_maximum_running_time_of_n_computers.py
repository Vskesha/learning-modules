class Solution:
    def maxRunTime(self, n: int, batteries: list[int]) -> int:
        if len(batteries) == n:
            return min(batteries)

        batteries.sort(reverse=True)

        extra = sum(batteries[n:])

        for i in range(1, n):
            low = batteries[n - i]
            high = batteries[n - i - 1]
            diff = high - low
            needed = diff * i
            if extra < needed:
                return batteries[n - i] + extra // i
            extra -= needed

        return batteries[0] + extra // n


def main():
    sol = Solution()
    print('4 ===', sol.maxRunTime(n=2, batteries=[3, 3, 3]))
    print('2 ===', sol.maxRunTime(n=2, batteries=[1, 1, 1, 1]))
    print('33559 ===', sol.maxRunTime(n=147, batteries=[5953, 9558, 9853, 5815, 405, 9649, 4681, 1409, 9590, 7101,
                                                        7031, 1837, 1109, 4906, 5300, 3438, 3506, 3331, 8728, 9917,
                                                        5750, 5349, 9986, 4370, 5812, 3429, 698, 4257, 9861, 705,
                                                        6973, 2438, 4103, 7748, 4361, 4041, 5838, 2930, 4670, 6286,
                                                        7980, 539, 3258, 6290, 1203, 4056, 9627, 5369, 609, 5986,
                                                        4117, 2210, 9393, 3302, 251, 9956, 2018, 2401, 5363, 4914,
                                                        3195, 2046, 4020, 9356, 3485, 784, 7763, 9542, 7540, 5157,
                                                        2339, 6007, 982, 9022, 1328, 6128, 2822, 9993, 5451, 5476,
                                                        5223, 8188, 8509, 517, 3162, 9367, 785, 4512, 3186, 8597,
                                                        4678, 7466, 9603, 4854, 45, 580, 8292, 3203, 3523, 1531,
                                                        3932, 1679, 8196, 4323, 9388, 6813, 1266, 1430, 8607, 7905,
                                                        5567, 1919, 6554, 5605, 9037, 9121, 3563, 1437, 149, 28,
                                                        8369, 1157, 5980, 3491, 6019, 9774, 9439, 5252, 2038, 9224,
                                                        6028, 9016, 9782, 3921, 7948, 3550, 4155, 7773, 5232, 5423,
                                                        8737, 2046, 4683, 3241, 5103, 2624, 9358, 7253, 547, 2828,
                                                        2420, 9840, 1703, 6493, 7025, 9155, 3931, 783, 2687, 223,
                                                        6027, 1411, 5670, 4627, 5309, 6273, 5581, 9241, 662, 8032,
                                                        1065, 5196, 6367, 2206, 5550, 8345, 3474, 6835, 2240, 6166,
                                                        2317, 3708, 4298, 412, 688, 1908, 234, 3274, 5700, 4713,
                                                        8141, 5049, 982, 4084, 6471, 2505, 3630, 4818, 2437, 8522,
                                                        6211, 5677, 4578, 5953, 2952, 6076, 6438, 3633, 4180, 8365,
                                                        3427, 3774, 854, 6727, 570, 4692, 446, 4190, 6059, 6144,
                                                        9823, 1006, 8642, 4111, 7496, 7338, 7954, 626, 1571, 6815,
                                                        7884, 2063, 2306, 8688, 4310, 6392, 2208, 8693, 4861, 8908,
                                                        4886, 6243, 8898, 6134, 8608, 5963, 8002, 2667, 821, 6997,
                                                        475, 608, 5526, 6827, 1144, 2004, 6180, 165, 3384, 6227,
                                                        5760, 3140, 1288, 4231, 8694, 6830, 9542, 4251, 2894, 3152,
                                                        8966, 1452, 6446,660,9865,2829,6810,1840,4581,1020,1343,4195,3055,9981,5923,1519,5138,9492,290,5124,3996,7080,7109,7717,5318,8581,2409,2518,4931,4895,9153,7789,7200,33,9400,6379,6982,1123,4011,4930,5893,9855,8359,1048,7975,6677,6292,7661,2196,1096,9754,3304,8586,6769,8247,52,4989,954,6205,8438,4457,6052,4556,8111,8325,6827,1802,8508,4321,8007,5449,7546,3942,3425,1278,3873,1793,3215,9869,164,5347,1117,7631,2855,5208,9681,4185,7817,4705,9033,2880,3862,6435,2812,8592,4873,4363,9834,501,7089,4433,3423,2213,967,6863,984,6363,9658,1210,9215,2363,7059,3124,1583,1052,9503,3753,5606,7055,5991,6245,8289,8067,210,5237,5231,7587,4980,3340,6122,8837,8379,382,4694,1329,3946,8224,4412,3272,1014,5135,7641,3544,1025,5333,4146,1809,6028,9183,1314,1271,3624,7934,4427,2778,8577,3629,7237,3861,7562,4161,6796,5565,628,9419,5073,301,8456,9438,7805,797,6508,3072,9946,8275,6907,2906,2121,6090,8812,6367,8890,6869,2977,294,8751,95,195,8141,1207,2348,4052,6372,9786,729,1330,6883,2340,3890,2009,3362,9465,9144,2903,2846,8759,3596,1505,9077,6730,7688,8364,8093,187,3193,1762,105,3401,4555,9810,4613,6901,1756,1967,5253,1796,78,6511,9493,6239,6784,5826,1734,6722,8342,9315,6182,2610,1434,5124,8428,5530,3561,8601,9749,44,7887,8017,2488,2432,4727,2622,6948,553,1731,446,7321,7305,4224,8120,4959,7250,4220,5557,9864,6689,5702,7731,8145,3278,9807,9835,7726,2929,2366,47,8391,6436,1301,5410,271,8061,4927,7820,9835,7519,1738,7557,194,3687,8226,3227,1251,2938,6792,2120,9454,528,8721,7394,167,9932,703,4049,9689,8377,8664,6919,7996,6754,6898,9000,7382,1734,9948,9469,8376,1951,3143,8770,6925,3200,5330,8598,5390,5409,6410,5651,4701,6726,5747,1275,946,9495,6919,7934,9385,8947,6471,4689,8117,8844,767,5974,8635,3972,408,8737,5472,1384,764,2287,5520,8986,5225,4490,7951,4176,7705,8700,5422,7736,9243,3250,7272,8252,5457,9443,2862,1267,2353,2637,5845,3362,3724,7076,6110,522,4195,2215,9270,5630,2469,3381,2043,1062,2317,1950,9406,388,4884,8215,9127,5353,2907,8883,7172,3601,1033,8015,5533,5912,3622,2354,1733,5577,4560,47,7737,5288,1391,6991,4504,9089,5179,9934,2646,2857,6171,9740,9462,2693,8143,9982,147,9060,7321,6351,3463,5750,6577,6475,474,1997,9084,6668,2101,9361,1755,7627,361,5272,1547,3824,7888,312,7984,1471,3724,7756,514,5616,7035,5402,840,9327,5713,1113,892,5614,7656,8166,2417,3490,3309,7822,3544,7089,3052,7701,7346,8137,8072,8394,844,3062,6631,946,854,6905,5405,22,2953,3039,4198,1237,189,9815,7032,8376,9515,6204,8968,7010,2904,7798,1454,338,9419,7043,1789,9465,4531,136,8223,9251,5755,1341,1569,8779,2524,398,8863,5300,2639,4839,553,308,2134,5805,768,6407,6083,1178,2,7819,2193,373,7249,4494,7510,5816,2724,1922,1747,9820,5464,5609,4456,5919,7148,7572,7194,846,4674,8641,6521,7122,7404,34,5902,8169,9049,4742,6410,756,2465,2033,6560,4429,2895,6186,1586,7626,2576,1280,8021,5964,5689,631,3683,459,2661,802,5645,7801,976,9381,8011,739,1684,4643,4994,7549,493,7771,9279,3470,8842,6679,4806,7741,3070,4867,7002,3677,3229,1857,2925,3974,717,5698,8572,9564,5779,823,6285,4385,4557,4268,6398,6471,3558,6969,1634,8801,1683,1390,4514,2093,8048,8927,9111,8683,4963,2031,1913,7927,2481,2215,1601,2642,5012,6718,1526,7864,8511,8626,2755,8184,6745,2879,645,3174,1124,74,2377,4302,2573,5073,1365,711,6816,1321,4043,74,3563,343,873,5884,52,7179,2033,1386,7419,3839,9880,2768,5317,1790,4395,5152,4348,6535,6237,546,5418,8572,4799,231,341,6308,7538,7632,1491,7949,66,1267,858,1900,4704,6157,8071,8835,5754,2992,1314,8689,3382,624,8525,1906,7834,9017,356,2363,2227,1675,5595,7232,6213,596,3214,6681,3883,2629,2267,4678,2492,8271,6110,865,9192,6058,7212]))


if __name__ == '__main__':
    main()
